Mock
==
- 금일 매출 통계를 메일 전송하는 기능을 추가.
- Mock은 가짜 객체를 주입하고 어떤 결과를 반환할지 지정할 수 있다.
- 즉, Mock 객체에 특정 메서드가 호출됐을 때 가짜 결과를 반환하도록 지정할 수 있다. 이를 stubbing이라고 한다.
- 테스트를 할 대상의 중간 결과가 필요없는 경우 사용할 수 있다.

## Test Double
- 배우를 대역하는 스턴트 맨을 영어로 스턴트 더블이라고한다.
- 테스트 대상 타겟을 대신 하는 대역을 테스트 더블이라고 한다.
- 테스트 더블
  - **Dummy**
    - 아무것도 하지 않는 깡통 객체
  - **Fake**
    - 단순한 형태로 동일한 기능은 수행하나, 프로덕션에서 쓰기에는 부족한 객체.
    - FakeRepository
  - **Stub**
    - 테스트에서 요청한 것에 대해 미리 준비한 결과를 제공하는 객체.
    - 그 외에는 응답하지 않는다.
    - 상태 검증에 중심을 두고 있다.
  - **Spy**
    - Sutb이면서 호출된 내용을 기록하여 보여줄 수 있는 객체.
    - 실제 객체처럼 동작시키고 일부만 subbing할 수 있다.
  - **Mock**
    - 행위에 대한 기대를 명세하고, 그에 따라 동작하도록 만들어진 객체.
    - 행위 검증에 중심을 두고 있다.


## Mockito로 검증하기.
- Mockito.mock(Class<T>)
  - Mockito 라이브러리를 사용해서, Mock 객체를 생성한다.
  - 실제 테스트 대상 객체에 Mock 객체를 주입하여 테스트를 진행한다.
- `@Mock`
  - Mockito.mock()을 호출하지 않고 어노테이션으로 생성이 가능하다.
- `@InjectsMock`
  - `@Mock` 객체를 주입한 테스트 대상 객체를 생성한다.
- `@Spy`
  - 실제 객체를 기반으로 생성되지만, 일부 기능을 stubbing 할 수 있다.

## BDDMockito
- 행위 주도 개발 패턴으로 작성된 Mockito 클래스

## Mocking
- Mocking을 언제 수행해야하나?
  - 외부 시스템을 호출할 때, 문제가 발생했을 때 어떻게 해결할 수 없는 문제이다.
  - 이 부분을 Mocking 처리한다.
- 실제 프로덕션 코드에서 런타임 시점에 일어날 일을 정확하게 Stubbing 했다고 단언 가능한가?
  - 비용을 조금 더 들여서 실제 구현체를 불러서 전체 테스트를 하는 것이 더욱 좋다.


## 키워드 정리
- Test Double, Stubbing
- @Mock, @MockBean, @Spy, @SpyBean, @InjectMocks
- BDDMockito
- Classist, Mockist

